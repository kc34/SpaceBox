<!DOCTYPE html>
<html>
<head>
<title>ThpatheBokth</title>
<link rel='shortcut icon' href='assets/favicon.ico' type='image/x-icon'/ >
</head>
<body>

<canvas id="myCanvas">
Your browser does not support the canvas element.
</canvas>

<style>
html, body {
  width:  100%;
  height: 100%;
  margin: 0px;
  overflow: hidden;
}
</style>

<script src="js/model.js"></script>
<script src="js/viewer.js"></script>
<script src="js/controller.js"></script>
<script src="js/bodies.js"></script>
<script src="js/lib/astro-math.js"></script>
<script src="assets/easing.js"></script>
<script src="assets/graphics.js"></script>

<script>
	
/**
 * Changelog:
 *  - Renamed View to Viewer.
 *  - Moved AstroMath from viewer.js to model.js.
 *  - Adding vectors and vector methods to AstroMath.
 *  - Removed rounded from ease-function calls.
 *  - Vector implementation. AstroMath now has teeth!
 *  - Viewer background size reduction decreased.
 *     - This raises the cap on the zoom out limit!
 *  - Space body minimum size on draw fixed.
 *  - Star changes color more gradually.
 */

var my_controller = new Controller();
var my_viewer = new Viewer();
var my_model =  new Sector();

/**
 * Other important global variables (e.g. time-keeping, environment)
 */

var TIME_STEP = 1.0 / 60; // Time-step. Measured in seconds.
var total_elapsed_time = 0.0;
var accumulator = 0.0;
var current_time = new Date();

/**
 * Runs physics-model and rendering separately, but on same thread.
 *
 */
function main() {
	
	new_time = new Date();
    frame_time = (new_time - current_time) / 1000;
	
    if ( frame_time > 0.1 )
        frame_time = 0.1;
    current_time = new_time;

    accumulator += frame_time;
    while ( accumulator >= TIME_STEP )
    {
        my_model.update(TIME_STEP);
        total_elapsed_time += TIME_STEP;
        accumulator -= TIME_STEP;
    }
    
	my_viewer.draw();
}

// Borrowed from http://stackoverflow.com/questions/1846599
function keydown_handler(key) {
	event = new AstroMath.Vector(event);
	my_controller.keydown_handler(key);
}

var canvas = document.getElementById("myCanvas");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

canvas.addEventListener('click', function(event) {
	my_controller["click_handler"](event);
}, false);

canvas.addEventListener('mousedown', function(event) {
	my_controller["mousedown_handler"](event);
}, false);

canvas.addEventListener('mouseup', function(event) {
	my_controller["mouseup_handler"](event);
}, false);

canvas.addEventListener('mousemove', function(event) {
	my_controller["mousemove_handler"](event);
}, false);

canvas.addEventListener('mousewheel', function(event) {
	my_controller["mousewheel_handler"](event);
}, false);

canvas.onmousedown = function(){return false;};


ctx = canvas.getContext("2d");

window.addEventListener('keydown', keydown_handler, false);

var mainLooper = setInterval(main, TIME_STEP);

</script>

</body>
</html>

